README for LB_SYS_PL_v*.*
       Written by T. Matsumura

Version history
2016-8-27: LB_SYSPL_v4.2
2014-10-2: LB_SYSPL_ver3.2
2013-12-25: LB_SYSPL_beta0.1
2013-12-20: LB_SYSPL_beta0.0

--------------------------------------------------------------------------------------------
Assumptions: 
	   - We assume you will be using this set of codes in kekcc.
	   - Accessible to the standard python tools, including python, numpy, pylab, scipy, healpy, ...
	   - For more details, check http://wiki.kek.jp/display/litebird/LB-SYSPL+README
--------------------------------------------------------------------------------------------

What this software does are followings

- read boresight pointing
- execute mapmaking and generate the maps per ces per pixel
- execute coadd the maps
#- compute the xpure window based on the mask generated by the coadded map
#- compute cls using xpure from the window

--------------------------------------------------------------------------------------------

Install
no compiling since it's all in python, just checkout as 
#> you have done this already since you are reading this.
                 
--------------------------------------------------------------------------------------------

One time only Initial setup

1) You need python2.7 or otherwise make sqlite3 available by yourself.
   You can check the version of python by 
   > python
      and see the first a few lines of messages.
   For your own installation, see more details in http://wiki.kek.jp/display/litebird/LB-SYSPL+README

2) set up the directory structure
   > cd LB_SYSPL_v4.2_release
   > cd Mapmake
   > ./init.sh

   open init.sh and modify followings
   example) for user, tmatsumu, 
	dir_mm=/home/cmb/tmatsumu/develop/LiteBIRD/projects/LB_SYSPL_v4.2_release/Simulator/
	dir_proj=/group/cmb/litebird/usr/tmatsumu/LB_SYSPL_v4.2_release/

3) you need to set the two basic directories in LB_SYSPL_v4.2_release/gen_run/global_par.py 
   > cd LB_SYSPL_v4.2_release/Simulator/gen_run
   open global_par.py and modify the followings
      dir_mm=Simulator/ (the directory path that includes gen_run)
       dir_proj=the path you set in the /project

--------------------------------------------------------------------------------------------

In order to run, you need to do the followings

1) go to 
   > cd /home/cmb/tmatsumu/develop/LiteBIRD/projects/LB_SYSPL_v4.2/Simulator/gen_run
   
   - define what you want to do in par_example.py
   - modify run_example.sh
   - onces it's ready to run
   > ./run_example.sh init
   > ./run_example.sh mm

2) if you can execute successfully, 
   check the status of the batch job
   > bjobs
   1 job contains 1 day of tod simulation and it takes ~15 min for this version.

3) once the job is done successfully,
   > ./run_example.sh coadd
   > bjobs
   This job should complete within a min

4) Once the above job is done succeslly,
   go to 
   > cd /home/cmb/tmatsumu/develop/LiteBIRD/projects/LB_SYSPL_v4.2/data_proj
   > cd SimedMaps/RunLog/example
   > ls
   > cd png
   > display mapT.png &

   For more questions, check http://wiki.kek.jp/display/litebird/LB-SYSPL+README
   or contact to tmatsumu@astro.isas.ajaxa.jp
